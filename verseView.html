<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <title>Verse View</title>
    <style>
        body {
            box-sizing: border-box;
        }

        .btn{
        
        }
    </style>
</head>

<body>

    <div class="container mt-4">
        <header class="d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom">
            <a href="index.html" class="d-flex align-items-center flex-column link-body-emphasis text-decoration-none">
                <img src="./images/PngItem_1141332.png" class="bi me-2" width="auto" height="60">
                <span class="fs-3">Shrimad Bhagavad Gita</span>
            </a>
        </header>

        <h1 class="text-center">Verse Details</h1>
        <div id="verseContainer" class="mt-5"></div>
    </div>

    <script>
        // Get query parameters
        const params = new URLSearchParams(window.location.search);
        const chapter = params.get('chapter');
        const verse = params.get('verse');

        // Check if chapter and verse are valid
        if (!chapter || !verse) {
            document.body.innerHTML = '<h3 class="text-center text-danger mt-5">Invalid Chapter or Verse Number</h3>';
        } else {
            fetchVerse(chapter, verse);
        }

        // Fetch verse details from API
        async function fetchVerse(chapter, verse) {
            try {
                // Fetch verse data
                const response = await fetch(`https://vedicscriptures.github.io/slok/${chapter}/${verse}`);
                if (!response.ok) {
                    throw new Error("Verse not found");
                }
                const data = await response.json();

                // Clean and display the verse
                const verseContainer = document.getElementById("verseContainer");
                const cleanEnglishTranslation = data.siva.et.replace(/[0-9\.]+/g, "").replace(/\s{2,}/g, " ");
                verseContainer.innerHTML = `
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <h2 class="card-title">Chapter ${chapter}, Verse ${verse}</h2>
                            <p class="card-text">${cleanEnglishTranslation}</p>
                        </div>
                    </div>`;
            } catch (error) {
                console.error("Error fetching verse:", error);
                document.body.innerHTML = `
                <div class="d-flex flex-column">
                    <h3 class="text-center text-danger mt-5">Wrong chapter or verse no. entered.! Verse does not exist</h3>
                    <a class="btn" href="index.html">back to homepage</a>
                </div>`;
            }
        }
    </script>

</body>

</html>
